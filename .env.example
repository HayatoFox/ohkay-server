# ============================================================================
# OHKAY SERVER - Multi-Database Architecture
# ============================================================================

# Application
NODE_ENV=production
PORT=8100

# ============================================================================
# AUTH DATABASE - Utilisateurs globaux
# ============================================================================
AUTH_DB_HOST=auth-db
AUTH_DB_PORT=5432
AUTH_DB_NAME=ohkay_auth

# ============================================================================
# DM DATABASE - Messages privés (compte à compte)
# ============================================================================
DM_DB_HOST=dm-db
DM_DB_PORT=5432
DM_DB_NAME=ohkay_dms

# ============================================================================
# REGISTRY DATABASE - Registre des serveurs
# ============================================================================
REGISTRY_DB_HOST=registry-db
REGISTRY_DB_PORT=5432
REGISTRY_DB_NAME=ohkay_server_registry

# ============================================================================
# DATABASE CREDENTIALS (partagées)
# ============================================================================
DB_USER=ohkay_user
DB_PASSWORD=change_this_secure_password

# ============================================================================
# DATABASE ADMIN - Pour création dynamique de DB (PostgreSQL unifié)
# ============================================================================
# Utilisés par l'application pour créer de nouvelles bases de données
# Nécessaires uniquement avec docker-compose.unified.yml
DB_HOST=postgres
DB_PORT=5432
DB_ADMIN_USER=postgres
DB_ADMIN_PASSWORD=change_this_postgres_admin_password
POSTGRES_PASSWORD=change_this_postgres_admin_password

# ============================================================================
# SECURITY
# ============================================================================
JWT_SECRET=change_this_to_a_very_secure_random_string_minimum_32_chars
INSTANCE_PASSWORD=your_server_password_here

# Chiffrement des mots de passe DB stockés dans registry
DB_ENCRYPTION_KEY=encryption_key_for_db_passwords_in_registry_32_chars

# Clé maître pour chiffrer les messages et DMs (TRÈS IMPORTANT !)
# Utilisée pour dériver les clés de chiffrement par utilisateur pour les DMs
# DOIT faire au moins 32 caractères
MASTER_ENCRYPTION_KEY=master_key_for_messages_encryption_32_chars_minimum

# ============================================================================
# VOICE SERVER (WebRTC mediasoup)
# ============================================================================
# IP publique du serveur pour WebRTC (pour clients externes)
# Si vide, mediasoup utilisera l'IP détectée automatiquement
VOICE_ANNOUNCED_IP=

# Plage de ports RTC pour mediasoup (TCP/UDP)
# Assurez-vous que ces ports sont ouverts dans le firewall
# 501 ports = ~250 connexions vocales simultanées
VOICE_RTC_MIN_PORT=7500
VOICE_RTC_MAX_PORT=8000

# ============================================================================
# OTHER
# ============================================================================
CORS_ORIGIN=*
LOG_LEVEL=info
